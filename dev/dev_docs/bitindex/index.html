<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BitIndex · BioSequences.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../"><img class="logo" src="../../assets/logo.png" alt="BioSequences.jl logo"/></a><h1>BioSequences.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../symbols/">Biological Symbols</a></li><li><a class="toctext" href="../../types/">BioSequences Types</a></li><li><a class="toctext" href="../../construction/">Constructing sequences</a></li><li><a class="toctext" href="../../transforms/">Indexing &amp; modifying sequences</a></li><li><a class="toctext" href="../../predicates/">Predicates</a></li><li><a class="toctext" href="../../random/">Random sequences</a></li><li><a class="toctext" href="../../sequence_search/">Pattern matching and searching</a></li><li><a class="toctext" href="../../demultiplexer/">Sequence Demultipllexing</a></li><li><a class="toctext" href="../../composition/">Sequence composition</a></li><li><a class="toctext" href="../../iteration/">Iteration</a></li><li><a class="toctext" href="../../counting/">Counting</a></li><li><a class="toctext" href="../../io/">I/O</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>BitIndex</a></li></ul><a class="edit-page" href="https://github.com/BioJulia/BioSequences.jl/blob/master/docs/src/dev_docs/bitindex.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>BitIndex</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="BitIndex-1" href="#BitIndex-1">BitIndex</a></h1><p>The BitIndex type is an important type in BioSequences internally. BioSequence types store their elements in a vector in a succinct and packed form, allowing multiple symbols (dna, rna, amino-acids, etc.) to be stored inside a single word. This has great performance benefits but makes some things more tricky. For example iterating though the encoded data of the sequence or keeping track of where in the binary array the elements begin and end.</p><p>We simplify this by keeping the length of encoded binary bits in a sequence fixed. Hence a character at arbitrary position can be extracted in a constant time. We then use this BitIndex type which represents the position of an element in the encoded bits as an index, and an offset. I.e Which chunk an element is stored in, and its offset inside of that chunk.</p><p>You can think of this visually:</p><h1><a class="nav-anchor" id="index(i)-1-index(i)-index(i)1-1" href="#index(i)-1-index(i)-index(i)1-1">index(i)-1        index(i)        index(i)+1</a></h1><h1><a class="nav-anchor" id="......................X.................................-1" href="#......................X.................................-1">....|................|..X.............|................|....</a></h1><h1><a class="nav-anchor" id="offset(i)-1" href="#offset(i)-1">|&lt;-offset(i)-|</a></h1><h1><a class="nav-anchor" id="–-64-bits-–-1" href="#–-64-bits-–-1">|&lt;–- 64 bits –&gt;|</a></h1><p>In the above diagram, the element pointed to is marked by X, <code>i</code> is the BitIndex and in this case the chunk size is 64 bits (although the BitIndex type supports other chunk sizes).</p><p>The BitIndex type has two parameters: <code>N</code> which is the number of bits used for each element, and <code>W</code>, which is the word (or chunk) size.</p><footer><hr/></footer></article></body></html>
